<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Source Themes Academic 4.8.0"><meta name=description content="This getting stated contains one ready-to-execute JAVA example starting from a new Gradle project.
The example demonstrate Keyple capabilities with the Keyple PCSC plugin and PO/SAM provided in the Calypso Test Kit."><link rel=alternate hreflang=en-us href=/keyple-website/docs/build-your-first-app/java-app/><link rel=preconnect href=https://fonts.gstatic.com crossorigin><meta name=theme-color content="#1D87BB"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/github.min.css crossorigin=anonymous title=hl-light><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/dracula.min.css crossorigin=anonymous title=hl-dark disabled><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin=anonymous async></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=%7CWork+Sans:ital,wght@0,300;1,500&display=swap"><link rel=stylesheet href=/keyple-website/css/academic.css><link rel=manifest href=/keyple-website/index.webmanifest><link rel=icon type=image/png href=/keyple-website/images/icon_hu16db34b3636b127457de39ca2fab620f_9845_32x32_fill_lanczos_center_2.png><link rel=apple-touch-icon type=image/png href=/keyple-website/images/icon_hu16db34b3636b127457de39ca2fab620f_9845_192x192_fill_lanczos_center_2.png><link rel=canonical href=/keyple-website/docs/build-your-first-app/java-app/><meta property="twitter:card" content="summary"><meta property="twitter:site" content="@keyple_org"><meta property="twitter:creator" content="@keyple_org"><meta property="og:site_name" content="Eclipse Keyple"><meta property="og:url" content="/keyple-website/docs/build-your-first-app/java-app/"><meta property="og:title" content="Build your First Java Application | Eclipse Keyple"><meta property="og:description" content="This getting stated contains one ready-to-execute JAVA example starting from a new Gradle project.
The example demonstrate Keyple capabilities with the Keyple PCSC plugin and PO/SAM provided in the Calypso Test Kit."><meta property="og:image" content="/keyple-website/images/logo_hu673a59176cd62c570f44ed2728665b48_42188_300x300_fit_lanczos_2.png"><meta property="twitter:image" content="/keyple-website/images/logo_hu673a59176cd62c570f44ed2728665b48_42188_300x300_fit_lanczos_2.png"><meta property="og:locale" content="en-us"><meta property="article:modified_time" content="2020-09-25T17:49:46+02:00"><script src=https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.1/cookieconsent.min.js integrity="sha256-5VhCqFam2Cn+yjw61zbBNrbHVJ6SRydPeKopYlngbiQ=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.1/cookieconsent.min.css integrity="sha256-zQ0LblD/Af8vOppw18+2anxsuaz3pWYyVWi+bTvTH8Q=" crossorigin=anonymous><script>window.addEventListener("load",function(){window.cookieconsent.initialise({"palette":{"popup":{"background":"#1D87BB","text":"#FFFFFF"},"button":{"background":"#FFFFFF","text":"#1D87BB"}},"theme":"classic","type":"opt-in","content":{"header":'Cookiessss used on the website!',"message":"Some Eclipse Foundation pages use cookies to better serve you when you return to the site. You can set your browser to notify you before you receive a cookie or turn off cookies. If you do so, however, some areas of some sites may not function properly. To read Eclipse Foundation Privacy Policy ","allow":"Allow cookies","deny":"Decline","dismiss":"Got it!","link":"click here","href":'https://www.eclipse.org/legal/privacy.php'},})});</script><title>Build your First Java Application | Eclipse Keyple</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents><script>window.staDarkLightChooser=true;</script><script>const isSiteThemeDark=false;</script><script src=/keyple-website/js/load-theme.js></script><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/keyple-website/><img src=/keyple-website/images/logo_hu673a59176cd62c570f44ed2728665b48_42188_0x70_resize_lanczos_2.png alt="Eclipse Keyple"></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/keyple-website/><img src=/keyple-website/images/logo_hu673a59176cd62c570f44ed2728665b48_42188_0x70_resize_lanczos_2.png alt="Eclipse Keyple"></a></div><div class="navbar-collapse main-menu-item collapse justify-content-center" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>What is Eclipse Keyple</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/keyple-website/what-is-keyple/main-features/><span>Keyple's main features</span></a>
<a class=dropdown-item href=/keyple-website/what-is-keyple/what-is-calypso/><span>What is Calypso?</span></a>
<a class=dropdown-item href=/keyple-website/what-is-keyple/who-is-it-for/><span>Who is it for?</span></a>
<a class=dropdown-item href=/keyple-website/what-is-keyple/why-trust/><span>Why trust Eclipse Keyple?</span></a>
<a class=dropdown-item href=/keyple-website/what-is-keyple/overview/><span>Overview</span></a></div></li><li class=nav-item><a class=nav-link href=/keyple-website/components/><span>Components</span></a></li><li class=nav-item><a class=nav-link href=/keyple-website/#news><span>News</span></a></li><li class=nav-item><a class="nav-link active" href=/keyple-website/docs/><span>Documentation</span></a></li><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>Support & Trainings</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/keyple-website/support-trainings/cna/><span>Calypso Networks Association</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class="nav-link js-theme-selector" data-toggle=dropdown aria-haspopup=true><i class="fas fa-palette" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar"><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-3" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation">
<span><i class="fas fa-bars"></i></span></button>
<input name=q type=search class=form-control placeholder=Search... autocomplete=off></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li><a href=/keyple-website/docs/></a></li><div class=docs-toc-item><a class=docs-toc-link href=/keyple-website/docs/architecture/><i class="fas fa-sitemap pr-1"></i>Architecture</a><ul class="nav docs-sidenav"><li><a href=/keyple-website/docs/architecture/keyple-global/>(WIP)Global Architecture</a></li><li><a href=/keyple-website/docs/architecture/keyple-core/>(WIP)Keyple Core</a></li><li><a href=/keyple-website/docs/architecture/keyple-calypso/>(WIP)Keyple Calypso</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/keyple-website/docs/build-your-first-app/><i class="fas fa-rocket pr-1"></i>Build your First App</a><ul class="nav docs-sidenav"><li class=active><a href=/keyple-website/docs/build-your-first-app/java-app/>(WIP)Java App</a></li><li><a href=/keyple-website/docs/build-your-first-app/android-app/>(WIP)Android App</a></li><li><a href=/keyple-website/docs/build-your-first-app/cpp-app/>(WIP)C++ App</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/keyple-website/docs/developer-guide/><i class="fas fa-chalkboard-teacher pr-1"></i>Developer Guides</a><ul class="nav docs-sidenav"><li><a href=/keyple-website/docs/developer-guide/develop-ticketing-app/>(WIP)Develop a Ticketing Application</a></li><li><a href=/keyple-website/docs/developer-guide/develop-plugin/>(WIP)Develop a Plugin</a></li><li><a href=/keyple-website/docs/developer-guide/develop-extension/>(WIP)Develop an Extension</a></li><li><a href=/keyple-website/docs/developer-guide/migration-0.8.1-to-0.9.0/>(WIP)Keyple Java 0.8.1 to 0.9.0</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/keyple-website/docs/api-reference/><i class="fas fa-plug pr-1"></i>API Reference</a></div></ul></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>Contents</a></li></ul><nav id=TableOfContents><ul><li><a href=#build>Build</a></li><li><a href=#run>Run</a></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main><article class=article><div class=docs-article-container><h1>Build your First Java Application</h1><div class=article-style><p>This getting stated contains one ready-to-execute JAVA example starting from a new Gradle project.</p><p>The example demonstrate Keyple capabilities with the Keyple PCSC plugin and PO/SAM provided in the Calypso Test Kit.</p><h2 id=build>Build</h2><p>The example can run on any machine: Linux, Windows and MacOS. If not installed in your machine, you will need to download :</p><p>Java 1.6 or newer</p><p>Gradle (any version) download</p><p>We recommend that you use a Java IDE like Eclipse or Intellij to create your new Gradle project.</p><p>Create a new Gradle project.</p><p>Add the following statements to your build.gradle file to import Keyple components into your project:</p><pre><code class=language-java>repositories {
    //to import snapshots
    maven {url 'https://oss.sonatype.org/content/repositories/snapshots' }
    //to import releases
    //maven { url 'https://oss.sonatype.org/content/repositories/releases' }
}

dependencies {
    //Keyple core is a mandatory library for using Keyple, in this case import the last version of keyple-java-core
    implementation group: 'org.eclipse.keyple', name: 'keyple-java-core', version: '+'

    //Import Calypso library to support Calypso Portable Object, in this case import the last version of keyple-java-calypso
    implementation group: 'org.eclipse.keyple', name: 'keyple-java-calypso', version: '+'

    //Import PCSC library to use a Pcsc reader, in this case import the last version of keyple-java-plugin-pcsc
    implementation group: 'org.eclipse.keyple', name: 'keyple-java-plugin-pcsc', version: '+'
}
</code></pre><p>Add the following statements to your build.gradle file to import Logger components into your project:</p><pre><code class=language-java>dependencies {
    implementation &quot;org.slf4j:slf4j-simple:1.7.25&quot;
    implementation &quot;org.slf4j:slf4j-ext:1.7.25&quot;
}
</code></pre><p>Copy the source code below in a new Java Class named Demo_CalypsoTestKit_App2_Pcsc:</p><pre><code class=language-java>/********************************************************************************
 * Copyright (c) Calypso Networks Association 2020 https://www.calypsonet-asso.org/
 *
 * See the NOTICE file(s) distributed with this work for additional information regarding copyright
 * ownership.
 *
 * This program and the accompanying materials are made available under the terms of the Eclipse
 * Public License 2.0 which is available at http://www.eclipse.org/legal/epl-2.0
 *
 * SPDX-License-Identifier: EPL-2.0
 ********************************************************************************/

import org.eclipse.keyple.calypso.command.po.parser.ReadDataStructure;
import org.eclipse.keyple.calypso.command.po.parser.ReadRecordsRespPars;
import org.eclipse.keyple.calypso.command.sam.SamRevision;
import org.eclipse.keyple.calypso.transaction.*;
import org.eclipse.keyple.core.selection.*;
import org.eclipse.keyple.core.seproxy.*;
import org.eclipse.keyple.core.seproxy.exception.KeypleBaseException;
import org.eclipse.keyple.core.seproxy.exception.KeypleReaderException;
import org.eclipse.keyple.core.seproxy.exception.NoStackTraceThrowable;
import org.eclipse.keyple.core.seproxy.protocol.SeCommonProtocols;
import org.eclipse.keyple.core.util.ByteArrayUtil;
import org.eclipse.keyple.plugin.pcsc.PcscPlugin;
import org.eclipse.keyple.plugin.pcsc.PcscPluginFactory;
import org.eclipse.keyple.plugin.pcsc.PcscProtocolSetting;
import org.eclipse.keyple.plugin.pcsc.PcscReader;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class Demo_CalypsoTestKit_App2_Pcsc  {

    private static final Logger logger =
            LoggerFactory.getLogger(Demo_CalypsoTestKit_App2_Pcsc.class);

    /* Plugin name */
    private final static String PLUGIN_NAME = &quot;PcscPlugin&quot;;
    /* PO Reader name */
    private final static String PO_READER_NAME = &quot;ASK LoGO 0&quot;;
    /* SAM Reader name */
    private final static String SAM_READER_NAME = &quot;Identive CLOUD 2700 R Smart Card Reader 0&quot;;

    /* AID: Keyple test kit profile 1, Application 2 */
    private final static String AID = &quot;315449432E49434131&quot;;


    private final static byte RECORD_NUMBER_1 = 1;

    private final static byte SFI_EnvironmentAndHolder = (byte) 0x07;


    public static void main(String[] args) throws KeypleBaseException, NoStackTraceThrowable {

        /* Get the instance of the SeProxyService (Singleton pattern) */
        SeProxyService seProxyService = SeProxyService.getInstance();

        logger.info(
                &quot;=================================================================================&quot;);
        logger.info(
                &quot;=                     Configuration of the PO &amp; SAM Readers                     =&quot;);
        logger.info(
                &quot;=================================================================================&quot;);

        /* Assign PcscPlugin to the SeProxyService */
        seProxyService.registerPlugin(new PcscPluginFactory());

        /* Get the PcscPlugin */
        ReaderPlugin plugin = seProxyService.getPlugin(PcscPlugin.PLUGIN_NAME);

        /* Get the PO reader */
        SeReader poReader = plugin.getReader(PO_READER_NAME);

        /* Sets the PO reader parameters for contactless secure elements */
        setContactlessSettings(poReader);

        /* Get a SAM reader */
        SeReader samReader = plugin.getReader(SAM_READER_NAME);

        /* Sets the reader parameters for contacts secure elements */
        setContactsSettings(samReader);

        logger.info(
                &quot;=================================================================================&quot;);
        logger.info(
                &quot;=                       Opening logical channel with the SAM                    =&quot;);
        logger.info(
                &quot;=================================================================================&quot;);
        /*
         * Open logical channel for the SAM inserted in the reader
         * (We expect the right is inserted)
         */
        SamResource samResource = checkSamAndOpenChannel(samReader);

        /* Check if the readers exists */
        if (poReader == null || samResource == null) {
            throw new IllegalStateException(&quot;Bad PO or SAM reader setup&quot;);
        }

        logger.info(&quot;======= Secure reading of Environment and Holder file &amp; Po Authentication =======&quot;);
        logger.info(&quot;= PO Reader  NAME = {}&quot;, poReader.getName());
        logger.info(&quot;= SAM Reader  NAME = {}&quot;, samResource.getSeReader().getName());

        /* Check if a PO is present in the reader */
        if (poReader.isSePresent()) {

            logger.info(
                    &quot;=================================================================================&quot;);
            logger.info(
                    &quot;=                       Start of the Calypso PO processing.                     =&quot;);
            logger.info(
                    &quot;=================================================================================&quot;);
            logger.info(
                    &quot;=                                1st PO exchange                                =&quot;);
            logger.info(
                    &quot;=                              AID based selection                              =&quot;);
            logger.info(
                    &quot;=================================================================================&quot;);

            /*
             * Prepare a Calypso PO selection
             */
            SeSelection seSelection = new SeSelection();

            /*
             * Setting of an AID based selection of a Calypso REV3 PO
             *
             * Select the first application matching the selection AID whatever the SE communication protocol
             * Keep the logical channel open after the selection
             *
             * Calypso PO selection: configures a PoSelectionRequest with all the desired attributes to
             * make the selection and read additional information afterwards
             */
            PoSelectionRequest poSelectionRequest = new PoSelectionRequest(
                    new PoSelector( //the selector to target a particular SE
                            SeCommonProtocols.PROTOCOL_ISO14443_4, // the SE communication protocol
                            null, // the ATR filter
                            new PoSelector.PoAidSelector( // the AID selection data
                                    new SeSelector.AidSelector.IsoAid(AID), // the application identifier
                                    PoSelector.InvalidatedPo.REJECT), // an enum value to indicate if an invalidated PO should be accepted or not
                            &quot;AID: &quot;+ AID), // information string (to be printed in logs)
                    ChannelState.KEEP_OPEN); // tell if the channel is to be closed or not after the command

            /*
             * Add the selection case to the current selection (we could have added other cases
             * here)
             */
            seSelection.prepareSelection(poSelectionRequest);

            /*
             * Actual PO communication: operate through a single request the Calypso PO selection
             * and the file read
             */
            SelectionsResult selectionsResult = seSelection.processExplicitSelection(poReader);

            if (selectionsResult.hasActiveSelection()) {
                MatchingSelection matchingSelection = selectionsResult.getActiveSelection();

                CalypsoPo calypsoPo = (CalypsoPo) matchingSelection.getMatchingSe();
                logger.info(&quot;The selection of the PO has succeeded.&quot;);

                logger.info(
                        &quot;=================================================================================&quot;);
                logger.info(
                        &quot;=                                2nd PO exchange                                =&quot;);
                logger.info(
                        &quot;=                             Open a secure session                             =&quot;);
                logger.info(
                        &quot;=                Reading of Environment and Holder file (SFI=07h)               =&quot;);
                logger.info(
                        &quot;=================================================================================&quot;);

                PoTransaction poTransaction = new PoTransaction(new PoResource(poReader, calypsoPo),
                        samResource, new SecuritySettings());

                /*
                 * Prepare the reading order and keep the associated parser for later use once the
                 * transaction has been processed.
                 */
                int readEnvironmentAndHolderParserIndex = poTransaction.prepareReadRecordsCmd(
                        SFI_EnvironmentAndHolder, // the sfi top select
                        ReadDataStructure.SINGLE_RECORD_DATA, // read mode enum to indicate a SINGLE, MULTIPLE or COUNTER read
                        RECORD_NUMBER_1, // the record number to read (or first record to read in case of several records)
                        String.format( // extra information included in the logs (can be null or empty)
                                &quot;EventLog (SFI=%02X, recnbr=%d))&quot;,
                                SFI_EnvironmentAndHolder,
                                RECORD_NUMBER_1));

                /*
                 * Open Session for the debit key
                 */
                boolean poProcessStatus = poTransaction.processOpening(
                        PoTransaction.ModificationMode.ATOMIC,
                        PoTransaction.SessionAccessLevel.SESSION_LVL_DEBIT, (byte) 0, (byte) 0);

                if (!poProcessStatus) {
                    throw new IllegalStateException(&quot;processingOpening failure.&quot;);
                }

                if (!poTransaction.wasRatified()) {
                    logger.info(
                            &quot;=================== Previous Secure Session was not ratified ====================&quot;);
                }


                /*
                 * Retrieve the data read from the parser updated during the transaction process
                 */
                byte EnvironmentAndHolderLog[] = (((ReadRecordsRespPars) poTransaction
                        .getResponseParser(readEnvironmentAndHolderParserIndex)).getRecords())
                        .get((int) RECORD_NUMBER_1);

                /* Log the result */
                logger.info(&quot;Environment And Holder file data: {}&quot;, ByteArrayUtil.toHex(EnvironmentAndHolderLog));

                logger.info(
                        &quot;=================================================================================&quot;);
                logger.info(
                        &quot;=                                3th PO exchange                                =&quot;);
                logger.info(
                        &quot;=                           Close the secure session                            =&quot;);
                logger.info(
                        &quot;=================================================================================&quot;);
                /*
                 * Close the Secure Session.
                 * A ratification command will be sent (CONTACTLESS_MODE).
                 */
                poProcessStatus = poTransaction.processClosing(ChannelState.CLOSE_AFTER);

                if (!poProcessStatus) {
                    throw new IllegalStateException(&quot;processClosing failure.&quot;);
                }

                logger.info(
                        &quot;=================================================================================&quot;);
                logger.info(
                        &quot;=                       Successful mutual authentication                        =&quot;);
                logger.info(
                        &quot;=                       End of the Calypso PO processing                        =&quot;);
                logger.info(
                        &quot;=================================================================================&quot;);
            } else {
                logger.error(&quot;The selection of the PO has failed.&quot;);
            }
        } else {
            logger.error(&quot;No PO were detected.&quot;);
        }
        System.exit(0);
    }

    /**
     * Sets the reader parameters for contactless secure elements
     *
     * @param reader the reader to configure
     * @throws KeypleBaseException in case of an error while settings the parameters
     */
    private static void setContactlessSettings(SeReader reader) throws KeypleBaseException {
        /* Enable logging */
        reader.setParameter(PcscReader.SETTING_KEY_LOGGING, &quot;true&quot;);

        /* Contactless SE works with T1 protocol */
        reader.setParameter(PcscReader.SETTING_KEY_PROTOCOL, PcscReader.SETTING_PROTOCOL_T1);

        /*
         * PC/SC card access mode:
         * The PO reader is set to EXCLUSIVE mode to avoid side effects during the selection step
         * that may result in session failures.
         */
        reader.setParameter(PcscReader.SETTING_KEY_MODE, PcscReader.SETTING_MODE_EXCLUSIVE);

        /* Set the PO reader protocol flag */
        reader.addSeProtocolSetting(
                SeCommonProtocols.PROTOCOL_ISO14443_4,
                PcscProtocolSetting.PCSC_PROTOCOL_SETTING.get(SeCommonProtocols.PROTOCOL_ISO14443_4));
    }

    /**
     * Sets the reader parameters for contacts secure elements
     *
     * @param reader the reader to configure
     * @throws KeypleBaseException in case of an error while settings the parameters
     */
    private static void setContactsSettings(SeReader reader) throws KeypleBaseException {
        /* Enable logging */
        reader.setParameter(PcscReader.SETTING_KEY_LOGGING, &quot;true&quot;);

        /* Contactless SE works with T0 protocol */
        reader.setParameter(PcscReader.SETTING_KEY_PROTOCOL, PcscReader.SETTING_PROTOCOL_T0);

        /*
         * PC/SC card access mode:
         * The SAM is left in the SHARED mode (by default) to avoid automatic resets due to the
         * limited time between two consecutive exchanges granted by Windows.
         */
        reader.setParameter(PcscReader.SETTING_KEY_MODE, PcscReader.SETTING_MODE_SHARED);

        /* Set the SAM reader protocol flag */
        reader.addSeProtocolSetting(
                SeCommonProtocols.PROTOCOL_ISO7816_3,
                PcscProtocolSetting.PCSC_PROTOCOL_SETTING.get(SeCommonProtocols.PROTOCOL_ISO7816_3));
    }

    /**
     * Check SAM presence and consistency and return a SamResource when everything is correct.
     *
     * Throw an exception if the expected SAM is not available
     *
     * @param samReader the SAM reader
     */
    private static SamResource checkSamAndOpenChannel(SeReader samReader) {
        /*
         * Check the availability of the SAM doing a ATR based selection,
         * open its physical and logical channels,
         * keep it open
         */
        SeSelection samSelection = new SeSelection();

        SamSelector samSelector = new SamSelector(SamRevision.C1, &quot;.*&quot;, &quot;Selection SAM C1&quot;);

        /* Prepare selector, ignore AbstractMatchingSe here */
        samSelection.prepareSelection(new SamSelectionRequest(samSelector, ChannelState.KEEP_OPEN));
        CalypsoSam calypsoSam;

        try {
            calypsoSam = (CalypsoSam) samSelection.processExplicitSelection(samReader)
                    .getActiveSelection().getMatchingSe();
            if (!calypsoSam.isSelected()) {
                throw new IllegalStateException(&quot;Unable to open a logical channel for SAM!&quot;);
            }
        } catch (KeypleReaderException e) {
            throw new IllegalStateException(&quot;SAM Reader exception: &quot; + e.getMessage());
        }
        return new SamResource(samReader, calypsoSam);
    }
}
</code></pre><p>Copy the properties file below in a new properties file named simplelogger.properties in resources. The application log output format is configurable in this properties files.</p><pre><code class=language-properties># SLF4J's SimpleLogger configuration file
# Simple implementation of Logger that sends all enabled log messages, for all defined loggers, to System.err.

# Default logging detail level for all instances of SimpleLogger.
# Must be one of (&quot;trace&quot;, &quot;debug&quot;, &quot;info&quot;, &quot;warn&quot;, or &quot;error&quot;).
# If not specified, defaults to &quot;info&quot;.
org.slf4j.simpleLogger.defaultLogLevel=trace

# Logging detail level for a SimpleLogger instance named &quot;xxxxx&quot;.
# Must be one of (&quot;trace&quot;, &quot;debug&quot;, &quot;info&quot;, &quot;warn&quot;, or &quot;error&quot;).
# If not specified, the default logging detail level is used.
#org.slf4j.simpleLogger.log.xxxxx=

# Set to true if you want the current date and time to be included in output messages.
# Default is false, and will output the number of milliseconds elapsed since startup.
org.slf4j.simpleLogger.showDateTime=true

# The date and time format to be used in the output messages.
# The pattern describing the date and time format is the same that is used in java.text.SimpleDateFormat.
# If the format is not specified or is invalid, the default format is used.
# The default format is yyyy-MM-dd HH:mm:ss:SSS Z.
org.slf4j.simpleLogger.dateTimeFormat=[HH:mm:ss:SSS]

# Set to true if you want to output the current thread name.
# Defaults to true.
org.slf4j.simpleLogger.showThreadName=true

# Set to true if you want the Logger instance name to be included in output messages.
# Defaults to true.
org.slf4j.simpleLogger.showLogName=false

# Set to true if you want the last component of the name to be included in output messages.
# Defaults to false.
org.slf4j.simpleLogger.showShortLogName=true

org.slf4j.simpleLogger.levelInBrackets=true
</code></pre><h2 id=run>Run</h2><p>Connect your PO and SAM readers.</p><p>Put the SAM in the SAM reader.</p><p>Place the PO on the PO reader.</p><p>Configure the PO and SAM readers you use in the java file (you have to respect the case for the reader name) :</p><pre><code class=language-java>    /* PO Reader name */
    private final static String PO_READER_NAME = &quot;XXX&quot;;
    /* SAM Reader name */
    private final static String SAM_READER_NAME = &quot;XXX&quot;;
</code></pre><p>If you don’t know the reader name, run the application in debug mode and get the reader name in plugin variable returned by:</p><blockquote><p>seProxyService.getPlugin(PLUGIN_NAME) methode: plugin -> readers -> X -> terminal -> name .</p></blockquote><p>Run the application.</p><p>Note: All project dependencies, including Keyple components, are downloaded during the first run, which can take several minutes.</p></div><div class=article-widget><div class=post-nav><div class=post-nav-item><div class=meta-nav>Next</div><a href=/keyple-website/docs/build-your-first-app/android-app/ rel=prev>Build your First Android Application</a></div></div></div></div><div class=body-footer><p>Last updated on Fri, Sep 25, 2020</p></div></article><style type=text/css media=screen>footer{background-color:#1d87bb}footer a{color:#fff}footer ul{padding-left:0}footer li{line-height:1.42857143;position:relative;display:block;color:#fff}</style><footer class=site-footer><div class=container><div class="row featurette"><div class="col-12 col-sm-4"><h4>More</h4><ul><li><a href=https://github.com/eclipse/keyple title="View Source Code on GitHub"><i class="fab fa-github"></i>GitHub Repository</a></li><li><a href=https://twitter.com/keyple_org title="Follow us on Twitter"><i class="fab fa-twitter"></i>Twitter</a></li><li><a href=https://accounts.eclipse.org/mailing-list/keyple-user title="Keyple progress information and user discussions"><i class="fas fa-envelope"></i>User mailing list</a></li><li><a href=https://accounts.eclipse.org/mailing-list/keyple-dev title="Keyple developer discussions"><i class="fas fa-envelope"></i>Developer mailing list</a></li></ul></div><div class="col-12 col-sm-4"><h4>Eclipse Foundation</h4><ul><li><a href=https://www.eclipse.org/org/>About Eclipse Foundation</a></li><li><a href=https://www.eclipse.org/org/foundation/contact.php>Contact Eclipse Foundation</a></li><li><a href=https://www.eclipse.org/donate>Donate</a></li><li><a href=https://www.eclipse.org/membership>Members</a></li><li><a href=https://www.eclipse.org/org/documents/>Governance</a></li><li><a href=https://www.eclipse.org/org/documents/Community_Code_of_Conduct.php>Code of Conduct</a></li><li><a href=https://www.eclipse.org/artwork/>Logo and Artwork</a></li><li><a href=https://www.eclipse.org/org/foundation/directors.php></a></li></ul></div><div class="col-12 col-sm-4"><h4>Legal</h4><ul><li><a href=https://www.eclipse.org/legal/privacy.php>Privacy Policy</a></li><li><a href=https://www.eclipse.org/legal/termsofuse.php>Terms of Use</a></li><li><a href=https://www.eclipse.org/legal/copyright.php>Copyright Agent</a></li><li><a href=https://www.eclipse.org/legal/epl-2.0/>Eclipse Public License</a></li><li><a href=https://www.eclipse.org/legal/>Legal Resources</a></li><li><a href=https://eclipse.org/security/ target=_blank>Report a Vulnerability</a></li></ul></section></div></div><p class=powered-by>Copyright © Eclipse Foundation, Inc. All Rights Reserved.</p><p class=powered-by>Powered by the
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> for
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.
<span class=float-right aria-hidden=true><a href=# class=back-to-top><span class=button_icon><i class="fas fa-chevron-up fa-2x"></i></span></a></span></p></footer></main></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js integrity="sha512-7t8APmYpzEsZP7CYoA7RfMPV9Bb+PJHa9x2WiUnDXZx3XHveuyWUtvNOexhkierl5flZ3tr92dP1mMS+SGlD+A==" crossorigin=anonymous></script><script>const code_highlighting=true;</script><script>const search_config={"indexURI":"/keyple-website/index.json","minLength":1,"threshold":0.3};const i18n={"no_results":"No results found","placeholder":"Search...","results":"results found"};const content_type={'post':"Posts",'project':"Projects",'publication':"Publications",'talk':"Talks",'slides':"Slides"};</script><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin=anonymous></script><script>anchors.add();</script><script id=search-hit-fuse-template type=text/x-template>
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=/keyple-website/js/academic.min.3b2b658c61ebd725bd5fc606c89fe44c.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i>Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i>Download</a><div id=modal-error></div></div></div></div></div></body></html>